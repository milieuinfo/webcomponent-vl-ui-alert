<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <script src="../../@webcomponents/webcomponentsjs/webcomponents-lite.js"></script>
    <script src="../../web-component-tester/browser.js"></script>

    <script type="module" src="../vl-alert.src.js"></script>
</head>
<body>
<test-fixture id="vl-alert-fixture">
    <template>
        <vl-alert></vl-alert>
    </template>
</test-fixture>

<script>
    suite('<vl-alert>', () => {
        const should = chai.should();

        // Te testen attributen: icon, title, closable, type, size
        // Te testen acties: sluiten van de alert


        // icon
        test('bevat shadow element met juiste icon class', () => {

            const alert = fixture('vl-alert-fixture');
            let val = "calendar";

            alert.setAttribute('icon',val);
            assert.isTrue(alert.shadowRoot.querySelector(".vl-vi").classList.contains("vl-vi-"+val))
        });


        //title
        test('bevat titel', () => {

            const alert = fixture('vl-alert-fixture');
            let val = "Zomaar een titel.";

            alert.setAttribute('title',val);
            assert.isTrue(alert.shadowRoot.querySelector(".vl-alert__title").textContent == val)
        });


        //size
        test('bevat shadow element met juiste size class', () => {

            const alert = fixture('vl-alert-fixture');
            const vals = ["small","large"];

            // valid values
            for (let val of vals){
                alert.setAttribute('size',val);
                assert.isTrue(alert.shadowRoot.querySelector(".vl-alert").classList.contains("vl-alert--"+val));
            }

            // invalid value
            let val = "blabla";
            alert.setAttribute('size',val);
            assert.isFalse(alert.shadowRoot.querySelector(".vl-alert").classList.contains("vl-alert--"+val));
        });


        // type
        test('bevat shadow element met juiste type class', () => {

            const alert = fixture('vl-alert-fixture');
            const vals = ["success","warning","error"];

            // valid values
            for (let val of vals){
                alert.setAttribute('type',val);
                assert.isTrue(alert.shadowRoot.querySelector(".vl-alert").classList.contains("vl-alert--"+val));
            }

            // invalid value
            let val = "blabla";
            alert.setAttribute('type',val);
            assert.isFalse(alert.shadowRoot.querySelector(".vl-alert").classList.contains("vl-alert--"+val));
        });


        //closable
        test('bevat sluit-knopje', () => {

            const alert = fixture('vl-alert-fixture');
            var closeBtn;

            closeBtn = alert.shadowRoot.querySelector("button");
            assert.isTrue(closeBtn == null);


            alert.setAttribute('closable','');
            closeBtn = alert.shadowRoot.querySelector("button");
            assert.isTrue(closeBtn != null);
            assert.isTrue(closeBtn.classList.contains("vl-alert__close"));

            alert.removeAttribute('closable');
            closeBtn = alert.shadowRoot.querySelector("button");
            assert.isTrue(closeBtn == null);

        });


        //alert closes
        test('sluit wanneer op sluit-knopje wordt geklikt', () => {

            const alert = fixture('vl-alert-fixture');
            alert.setAttribute('closable','');

            const closeBtn = alert.shadowRoot.querySelector("button");

            assert.isTrue(document.body.contains(alert));
            closeBtn.click();
            assert.isFalse(document.body.contains(alert));
        });
    });
</script>
</body>
</html>